# BLE 功能对比清单

## 📊 Dart vs Web 功能对比

### ✅ 已实现功能

| 命令 | 功能 | Dart方法 | Web方法 | 状态 |
|------|------|----------|---------|------|
| 1 | 设备握手绑定 | firstHander + sendToken | bindDevice | ✅ |
| 2 | 读取序列号 | readSsn | bindDevice | ✅ |
| 3 | 获取设备状态 | readStatus | getDeviceStatus | ✅ |
| 4 | 时间同步 | syncTime | syncTime | ✅ |
| 6 | 获取存储空间 | getStorageVolume | getStorageVolume | ✅ |
| 8 | 通用设置 | generalSetting | getGeneralSetting | ✅ |
| 9 | 获取电量 | getBatt | getBatteryLevel | ✅ |
| 10 | 打开WiFi | openWifi | openWifi | ✅ |
| 12 | USB模式 | setUsbMode | setUsbMode | ✅ |
| 13 | 系统版本 | getZhiyinosVersion | getSystemVersion | ✅ |
| 20 | 开始录音 | recordStart | startRecord | ✅ |
| 21 | 暂停录音 | recordPause | pauseRecord | ✅ |
| 22 | 恢复录音 | recordRestore | resumeRecord | ✅ |
| 23 | 停止录音 | recordEnd | stopRecord | ✅ |
| 26 | 获取文件列表 | getSesionList | loadDeviceFile | ✅ 部分 |
| 33 | 获取灯效 | (命令33) | getRecordLed | ✅ |
| 34 | 设置灯效 | (命令34) | setRecordLed | ✅ |
| 110 | 心跳包 | (命令110) | sendHeartbeat | ✅ |

### ❌ 缺失功能

#### 高优先级（常用功能）

| 命令 | 功能 | Dart方法 | 说明 |
|------|------|----------|------|
| 5 | 解绑设备 | unbind | 解除设备绑定 |
| 7 | 重置密码 | resetPassword | 重置设备密码 |
| 11 | 关闭WiFi (正确命令) | closeWifi | 当前使用的是命令14 |
| 14 | 配置WiFi | configWifi | 配置WiFi SSID和密码 |
| 15 | 搜索WiFi | searchWifi | 搜索可用WiFi列表 |
| 24 | 获取灯光状态 | getLightStatus | 获取设备灯光状态 |
| 25 | 设置LED状态 | setLedStatus | 设置LED灯效 |
| 30 | 删除录音 | delRecord | 删除设备上的录音文件 |
| 104 | 清除数据 | clearData | 清除设备数据 |

#### 中优先级（文件管理）

| 命令 | 功能 | Dart方法 | 说明 |
|------|------|----------|------|
| 28 | 同步文件 | syncFile | 从设备同步录音文件 |
| 29 | 停止同步 | syncFileStop | 停止文件同步 |
| 31 | 删除确认 | (响应31) | 删除文件的确认响应 |
| 35 | 录音打点数据 | (响应35) | 获取录音打点数据 |

#### 低优先级（高级功能）

| 命令 | 功能 | Dart方法 | 说明 |
|------|------|----------|------|
| 50 | 启动OTA | setOta | OTA固件升级 |
| 51 | OTA完成 | setOtaFinish | OTA升级完成 |
| 52 | OTA重传 | (响应52) | OTA数据重传 |
| 61 | 操作数据 | reqOperData | 请求操作数据/埋点 |
| 103 | 隐私设置 | (响应103) | 隐私设置确认 |
| 类型3 | OTA数据 | setOtaData | OTA数据传输 |

### 📋 响应处理对比

| 命令 | Dart | Web | 状态 |
|------|------|-----|------|
| 1 | ✅ | ✅ | 设备信息响应 |
| 2 | ✅ | ✅ | 序列号响应 |
| 3 | ✅ | ✅ | 设备状态响应 |
| 4 | ✅ | ✅ | 时间同步响应 |
| 6 | ✅ | ✅ | 存储空间响应 |
| 7 | ✅ | ❌ | 重置密码响应 |
| 8 | ✅ | ✅ | 通用设置响应 |
| 9 | ✅ | ✅ | 电量响应 |
| 10 | ✅ | ✅ | WiFi开启响应 |
| 11 | ✅ | ❌ | 模式开关响应 |
| 12 | ✅ | ✅ | USB响应 |
| 13 | ✅ | ✅ | 系统版本响应 |
| 14 | ✅ | ✅ | WiFi关闭响应 |
| 15 | ✅ | ❌ | WiFi配网响应 |
| 20 | ✅ | ✅ | 录音开始响应 |
| 21 | ✅ | ✅ | 录音暂停响应 |
| 22 | ✅ | ✅ | 录音恢复响应 |
| 23 | ✅ | ✅ | 录音停止响应 |
| 24 | ✅ | ❌ | 灯光状态响应 |
| 26 | ✅ | ✅ | 文件列表响应 |
| 28 | ✅ | ✅ | 文件头响应 |
| 29 | ✅ | ✅ | 文件尾响应 |
| 30 | ✅ | ✅ | 停止同步响应 |
| 31 | ✅ | ✅ | 删除确认响应 |
| 33 | ✅ | ✅ | 灯效状态响应 |
| 34 | ✅ | ✅ | 灯效设置响应 |
| 35 | ✅ | ❌ | 打点数据响应 |
| 50 | ✅ | ❌ | OTA通知响应 |
| 51 | ✅ | ❌ | OTA完成响应 |
| 52 | ✅ | ❌ | OTA重传响应 |
| 61 | ✅ | ❌ | 埋点数据响应 |
| 103 | ✅ | ❌ | 隐私设置响应 |
| 104 | ✅ | ❌ | 清除数据响应 |
| 110 | ✅ | ✅ | 心跳包响应 |

## 📈 完成度统计

- **核心功能**: 17/17 (100%) ✅
- **WiFi管理**: 2/5 (40%) ⚠️
- **文件管理**: 1/6 (17%) ❌
- **OTA升级**: 0/3 (0%) ❌
- **其他功能**: 2/7 (29%) ⚠️

**总体完成度**: 22/38 (58%)

## 🎯 推荐实现优先级

### 第一优先级（必需）
1. ✅ 解绑设备 (命令5)
2. ✅ 重置密码 (命令7)
3. ✅ 配置WiFi (命令14)
4. ✅ 搜索WiFi (命令15)
5. ✅ 删除录音 (命令30)
6. ✅ 清除数据 (命令104)

### 第二优先级（重要）
1. 文件同步 (命令28, 29)
2. 灯光状态 (命令24, 25)
3. WiFi命令修正 (命令11)

### 第三优先级（可选）
1. OTA升级 (命令50, 51, 52)
2. 埋点数据 (命令61)
3. 录音打点 (命令35)

